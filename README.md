# Restaurant POS Frontend

飲食店向けマルチテナント対応POSシステムのフロントエンド群。

## ディレクトリ構成

```
front/
├── apps/
│   ├── staff/          # スタッフ向け（システム管理）
│   ├── tenant/         # テナント向け（店舗オーナー・マネージャー）
│   ├── store/          # 店舗向け（POS画面・注文管理）
│   └── customer/       # 顧客向け（セルフオーダー・予約）
├── packages/
│   └── ui/             # 共通UIコンポーネント
├── turbo.json          # Turborepo設定
├── pnpm-workspace.yaml # pnpm workspaces設定
└── package.json
```

## 各アプリケーションの役割

| アプリ | 対象ユーザー | 主な機能 | デプロイ先例 |
|--------|-------------|---------|-------------|
| staff | システム管理者 | テナント管理、プラン管理、システム設定 | staff.example.com |
| tenant | テナントオーナー・マネージャー | 店舗設定、メニュー管理、売上分析、スタッフ管理 | admin.example.com |
| store | 店舗スタッフ | 注文受付、調理管理、配膳管理、会計 | pos.example.com |
| customer | 一般顧客 | セルフオーダー、予約、履歴確認 | order.example.com |

## 技術選定

### Turborepo + pnpm workspaces を選択した理由

#### 1. モノレポ管理の必要性

4つのフロントエンドアプリケーションが存在し、以下の課題がある：
- 共通UIコンポーネントの重複開発を避けたい
- 依存関係のバージョンを統一したい
- 開発体験を統一したい

#### 2. pnpm workspaces

**選定理由:**
- npm/yarnより高速なインストール（ハードリンク活用）
- 厳格な依存関係管理（幽霊依存関係を防止）
- ディスク容量の効率化
- `pnpm -F <app> <command>` で特定アプリのみ操作可能

#### 3. Turborepo

**選定理由:**
- **ビルドキャッシュ**: 変更のないパッケージはビルドをスキップ
- **並列実行**: 依存関係を考慮した最適な並列ビルド
- **リモートキャッシュ**: CI/CD間でキャッシュを共有可能
- **Next.js公式推奨**: Vercel製でNext.jsとの相性が最良

**具体的なメリット:**
```
# 4アプリ全ビルド時間の比較（概算）
従来: 各アプリ60秒 × 4 = 240秒（直列）
Turborepo: 60秒（並列） + キャッシュで2回目以降は数秒
```

### 各アプリケーションの技術スタック

| 技術 | バージョン | 選定理由 |
|------|-----------|---------|
| Next.js | 14 (App Router) | RSC対応、SSR/SSG柔軟、Vercelとの親和性 |
| TypeScript | 5+ | 型安全、開発効率向上 |
| Tailwind CSS | 3+ | ユーティリティファースト、共通デザイントークン |
| React | 18+ | Server Components、Suspense対応 |

### PWA対応（store/customer向け）

店舗POSと顧客向けアプリはPWA対応：
- オフライン動作（店舗の通信障害対策）
- ホーム画面追加
- プッシュ通知

## 開発コマンド

```bash
# 依存関係インストール
pnpm install

# 全アプリ開発サーバー起動
pnpm dev

# 特定アプリのみ起動
pnpm -F staff dev
pnpm -F tenant dev
pnpm -F store dev
pnpm -F customer dev

# 全アプリビルド
pnpm build

# 特定アプリのみビルド
pnpm -F store build

# 型チェック
pnpm typecheck

# Lint
pnpm lint
```

## 実装状況

### Staff (port 3001 - apps/staff)

**システム管理者向け** - テナント管理、プラン管理、システム設定

#### 実装済み ✅

| 画面 | URL | 機能 |
|------|-----|------|
| ログイン | http://localhost:3001/login | スタッフ認証 |

#### 実装予定 📋

- [ ] ダッシュボード (`/dashboard`) - システム全体の統計、アクティブテナント数
- [ ] テナント管理 (`/tenants`) - テナント一覧、作成、編集、削除、プラン変更
- [ ] サブスクリプション管理 (`/subscriptions`) - プラン管理、料金設定
- [ ] システム設定 (`/settings`) - グローバル設定、機能フラグ

---

### Tenant (port 3002 - apps/tenant)

**テナントオーナー・マネージャー向け** - 店舗設定、メニュー管理、売上分析

#### 実装済み ✅

| 画面 | URL | 機能 | 権限 |
|------|-----|------|------|
| ログイン | http://localhost:3002/login | テナント認証 | 全員 |
| ダッシュボード | http://localhost:3002/dashboard | 今日の売上・注文数、アクティブな注文、人気メニューTop5（30秒自動更新） | manager以上 |
| メニュー管理 | http://localhost:3002/menu | メニューのCRUD、カテゴリ管理、価格設定、有効/無効切替 | manager以上 |
| 売上レポート | http://localhost:3002/reports | 日次・月次・メニュー別売上分析 | manager以上 |
| 店舗管理 | http://localhost:3002/stores | 店舗のCRUD、店舗情報管理（住所・電話番号・有効/無効） | manager以上 |
| ユーザー管理 | http://localhost:3002/users | ユーザーのCRUD、ロール管理（owner/manager/staff/kitchen_staff/cashier） | **owner専用** |

#### 実装予定 📋

- [ ] 店舗設定 (`/stores/:id/settings`) - 店舗ごとの詳細設定
  - [ ] 配膳中ステータスの有効/無効
  - [ ] 営業時間設定
  - [ ] テーブル数設定
  - [ ] 税率設定
- [ ] テーブル管理 (`/tables`) - テーブル番号管理、テーブルマップ
- [ ] 在庫管理 (`/inventory`) - 在庫状況、発注管理
- [ ] 顧客管理 (`/customers`) - 顧客情報、来店履歴、ポイント管理
- [ ] 予約管理 (`/reservations`) - 予約一覧、予約受付、席割り当て
- [ ] クーポン管理 (`/coupons`) - クーポン作成、配布、利用状況

---

### Store (port 3003 - apps/store)

**店舗スタッフ向け** - 注文受付、調理管理、配膳管理、会計

#### 実装済み ✅

| 画面 | URL | 機能 |
|------|-----|------|
| ログイン | http://localhost:3003/login | 店舗スタッフ認証 |
| 注文作成 | http://localhost:3003/order | メニュー選択、注文送信、テーブル番号入力 |
| 厨房ディスプレイ | http://localhost:3003/kitchen | 注文キュー管理（待機中→調理中→調理完了→配膳済み）、ステータス更新 |
| 会計 | http://localhost:3003/payment | 注文確認、会計処理、領収書発行 |

#### 実装予定 📋

- [ ] テーブルマップ (`/order`) - ビジュアルテーブル選択（テーブル番号入力の簡略化）
- [ ] 店舗選択機能 - ログイン後の店舗選択（複数店舗運用時）
- [ ] オフライン対応 - PWA化、ローカルストレージ活用
- [ ] プリンター連携 (`/kitchen`) - 厨房プリンター自動出力
- [ ] 売上日報 (`/daily-report`) - 日次締め処理、売上サマリー
- [ ] 在庫確認 (`/inventory`) - リアルタイム在庫確認、品切れ通知

---

### Customer (port 3004 - apps/customer)

**一般顧客向け** - セルフオーダー、予約、履歴確認

#### 実装済み ✅

なし

#### 実装予定 📋

- [ ] ログイン・会員登録 (`/login`, `/register`) - 顧客認証、SNS連携
- [ ] QRコードオーダー (`/order/:table_id`) - QRコード読み取り、セルフオーダー
- [ ] メニュー閲覧 (`/menu`) - メニュー一覧、商品詳細、アレルギー情報
- [ ] 注文履歴 (`/history`) - 過去の注文確認、再注文
- [ ] 予約 (`/reservations`) - 席予約、日時選択、人数指定
- [ ] マイページ (`/mypage`) - 会員情報編集、ポイント確認
- [ ] クーポン (`/coupons`) - 利用可能クーポン一覧、適用

---

## 開発優先順位

### 高優先度 🔴

1. **店舗設定機能** - 配膳中ステータス有無などの店舗ごとの設定
2. **店舗選択機能** - 複数店舗運用時のログイン後店舗選択
3. **テーブルマップ** - テーブル番号入力の簡略化

### 中優先度 🟡

4. **Staff管理画面** - システム管理者向けダッシュボード・テナント管理
5. **Customer向けQRオーダー** - セルフオーダー機能
6. **在庫管理** - 在庫状況確認、品切れ管理

### 低優先度 🟢

7. **予約管理** - 顧客予約受付・席割り当て
8. **クーポン機能** - クーポン作成・配布・利用
9. **オフライン対応** - PWA化、ローカルストレージ活用

---

## Git管理

- リポジトリ: https://github.com/ryou-2004/restaurant-pos-front
- APIリポジトリ: https://github.com/ryou-2004/restaurant-pos-api

## 関連ドキュメント

- [API仕様](../api/README.md)
- [システム設計](../docs/)
